<script>
  let mined = 0;
  const cooldown = 24 * 60 * 60 * 1000; // 24 hours
  const mineBtn = document.getElementById('mineButton');
  const coinsDisplay = document.getElementById('coins');
  const timerText = document.getElementById('timerText');

  let userMoved = false;
  let waitStart = Date.now();
  let antiBotPassed = false;

  // Detect user interaction (mouse or touch)
  function markUserMoved() {
    if (!userMoved) {
      userMoved = true;
      waitStart = Date.now(); // Reset wait timer when user moves
    }
  }

  document.addEventListener('mousemove', markUserMoved);
  document.addEventListener('touchstart', markUserMoved);

  function getLastMineTime() {
    return parseInt(localStorage.getItem('lastMine') || 0);
  }

  function updateTimer() {
    const now = Date.now();
    const lastMine = getLastMineTime();
    const diff = cooldown - (now - lastMine);

    if (diff > 0) {
      mineBtn.disabled = true;
      const hrs = Math.floor(diff / (1000 * 60 * 60));
      const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const secs = Math.floor((diff % (1000 * 60)) / 1000);
      timerText.textContent = `Next mine in: ${hrs}h ${mins}m ${secs}s`;
    } else {
      // Check anti-bot conditions
      const waitElapsed = Date.now() - waitStart;
      antiBotPassed = userMoved && waitElapsed > 5000;

      if (antiBotPassed) {
        mineBtn.disabled = false;
        timerText.textContent = '';
      } else {
        mineBtn.disabled = true;
        timerText.textContent = 'Move your finger or mouse and wait 5 seconds to enable mining.';
      }
    }
  }

  mineBtn.onclick = () => {
    if (!antiBotPassed) {
      alert("Bot protection active. Please interact with the page first.");
      return;
    }
    mined += 1;
    coinsDisplay.textContent = mined;
    localStorage.setItem('lastMine', Date.now());
    updateTimer();
  };

  setInterval(updateTimer, 1000);
  updateTimer();
</script>
